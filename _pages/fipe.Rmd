---
title: "EDA: Brazilian Car Prices"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library(dplyr)
library(data.table)
library(purrr)
library(ggridges)
library(viridis)
library(gridExtra)
library(grid)
```

### Read Data

You can include R code in the document as follows:

```{r echo=TRUE}
fipe <- fread("/home/ddantas/project/pre_git/FIPE/data/veiculos_preco_junho_de_2018.csv")
```
```{r echo = FALSE}
fipe<-fipe[,.("brand"=fipe_marca,"vehicle"=veiculo,"year_model"=ano_modelo,"fuel"=combustivel,"price_reference"="June 2018",price)][,fuel:=ifelse(fuel=="Gasolina","Gasoline",
                                                                                                                                                  ifelse("Alcool","Alcohol",fuel))]

head(fipe)
```

I believe the data is pretty simple and intuitive. Two important points here are: (1) prices are in real (Brazilian currency); (2) price_reference is the moment the price was **calculated, in this case it was June 2018.

This information is monthly released by FIPE, a Brazilian instute.


### Vehicles by brand

You can also embed plots, for example:

```{r pressure, echo=TRUE}
options(repr.plot.width=10, repr.plot.height=4)
fipe%>%
group_by(brand)%>%
summarise(count=n())%>%
mutate(flag=ifelse(count>2000,1,0))%>%
ggplot(aes(x=reorder(brand,-count),y=count))+
geom_col(aes(fill=as.factor(flag)))+xlab("")+ylab("")+guides(fill=FALSE)+
theme_minimal()+theme(axis.text.x = element_text(angle=70,vjust = 0.7))
```



**VW**, **GM - Chevrolet**, **Fiat** and **Ford** are the top 4 brands of with more than 2,000 vehicles each.

This number takes into account every year model available.

### Only Brand New Cars

```{r}
fipe%>%
group_by(brand)%>%
filter(year_model=="32000")%>%
summarise(count=n())%>%
mutate(flag=ifelse(count>2000,1,0))%>%
ggplot(aes(x=reorder(brand,-count),y=count))+
geom_col(aes(fill=as.factor(flag)))+xlab("")+ylab("")+guides(fill=FALSE)+
theme_minimal()+theme(axis.text.x = element_text(angle=70,vjust = 0.7))
```

